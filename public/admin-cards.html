<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Cards â€” Herd Mentality Game</title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; max-width:900px; margin:40px auto; background:#f9f9f9; }
    h1 { text-align:center; margin-bottom:20px; }
    input,button { font-size:16px; padding:8px; margin:6px 0; }
    #questionText { width:70%; max-width:700px; display:inline-block; }
    #addBtn { display:inline-block; margin-left:8px; }
    table { width:100%; border-collapse:collapse; margin-top:12px; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    th,td { border:1px solid #ccc; padding:8px; text-align:left; }
    th { background:#eee; }
    .btn { background:#333; color:#fff; padding:8px 12px; border-radius:6px; text-decoration:none; }
    .btn:hover { background:#F7AC4D; }
    .bottom-bar { margin-top:20px; text-align:center; }
  </style>
</head>
<body>
  <h1>Cards</h1>
  <a class="btn" href="/admin-dashboard.html">Back to Dashboard</a>
  <div>
    <input id="questionText" placeholder="New question text" />
    <button id="addBtn">Add Question</button>
  </div>
  <table id="cardsTable">
    <thead>
      <tr><th>ID</th><th>Question</th><th>Sort Number</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <!-- Bottom back button -->
  <div class="bottom-bar">
    <a class="btn" href="/admin-dashboard.html">Back to Dashboard</a>
  </div>
  <script>
    async function loadQuestions(){
      const res = await fetch('/api/questions');
      const qs = await res.json();
      document.querySelector('#cardsTable tbody').innerHTML = qs.map(q =>
        `<tr><td>${q.id}</td><td>${escapeHTML(q.prompt)}</td><td>${q.sort_number || q.id}</td></tr>`
      ).join('');
    }

    document.getElementById('addBtn').onclick = async () => {
      const text = document.getElementById('questionText').value.trim();
      if (!text) return alert('Enter a question');
      const res = await fetch('/api/questions', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({ text })
      });
      if (res.ok) {
        document.getElementById('questionText').value='';
        loadQuestions();
      } else {
        const err = await res.json().catch(()=>({}));
        alert(err.error || 'Failed to add question');
      }
    };

    function escapeHTML(str){
      const div=document.createElement('div');
      div.innerText=String(str||"");
      return div.innerHTML;
    }

    loadQuestions();
  </script>
</body>
</html>
